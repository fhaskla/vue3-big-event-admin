import{t as w,q as l,e as _,w as t,o as u,y as r,f as a,L as E,z as B,C as m,E as v,bS as U,M as x,aW as y,bT as S}from"./index-BtdZa8Qe.js";import{_ as A,E as C}from"./_plugin-vue_export-helper-CkUarTxb.js";import{E as L}from"./el-progress-BqP9tthG.js";import{P as R}from"./PageContainer-YCxXl0ht.js";import{F as I}from"./FormBody-B0cIz5IE.js";import"./el-message-CgnsFL7S.js";import"./isEqual-BeSQZJ7H.js";const M=["src"],N={style:{"margin-top":"20px"}},V={__name:"Avatar",setup(q){const f=w(),n=l(f.userInfo.user_pic),i=l(null),d=l(),c=l(!1);function g(s){let e=!0;if(s.raw.type.startsWith("image/")||(e=!1),s.size>1024*1024*5&&(e=!1),!e)return v.error("仅允许 5MB 以内的图片文件");n.value=URL.createObjectURL(s.raw);const o=new FileReader;o.readAsDataURL(s.raw),o.onload=()=>{i.value=o.result}}async function k(){c.value=!0,await U(i.value),await f.setUserInfo(),c.value=!1,v.success("更换头像成功")}return(s,e)=>{const o=x,b=L,p=C;return u(),_(R,{title:"更换头像"},{default:t(()=>[r(I,null,{default:t(()=>[r(b,{ref_key:"upload",ref:d,class:"avatar-uploader","show-file-list":!1,"on-change":g,"auto-upload":!1},{default:t(()=>[a(n)?(u(),E("img",{key:0,src:a(n),class:"avatar",alt:""},null,8,M)):(u(),_(o,{key:1,class:"avatar-uploader-icon"},{default:t(()=>[r(a(y))]),_:1}))]),_:1},512),B("div",N,[r(p,{onClick:e[0]||(e[0]=z=>a(d).$el.querySelector("input[type=file]").click()),icon:a(y),type:"primary"},{default:t(()=>e[1]||(e[1]=[m(" 选择图片 ")])),_:1},8,["icon"]),r(p,{type:"success",disabled:!a(i),onClick:k,icon:a(S),loading:a(c)},{default:t(()=>e[2]||(e[2]=[m(" 更换头像 ")])),_:1},8,["disabled","icon","loading"])])]),_:1})]),_:1})}}},D=A(V,[["__scopeId","data-v-b6b796d4"]]);export{D as default};
